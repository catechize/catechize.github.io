"use strict";(self.webpackChunkexternal_site=self.webpackChunkexternal_site||[]).push([[6274],{56263:function(e,o,t){var s=t(81923),n=t(58156),a=t.n(n),r=t(89e3),l=t(7237),i=t(17798),c=t(81726),d=t(29245),u=t(12801),p=t(74744),g=t(80951),m=t(98856),h=t(21226),x=t(29237),j=t(71083),w=t(7425),f=t(89840),_=t.n(f),v=t(96540),A=t(29371),b=t(2114),y=t(34033),S=t(14617),C=t(95341),k=t(1759),E=t(16808),I=t(63314),T=t(12664),z=t(69319),R=t(1818),N=t(96161),W=t(50476),F=t(17437);const{colors:{dt_taro10:H,dt_taro50:Y,dt_taro80:$}}=k.w4,O=(0,s.A)("div",{target:"eldja686"})({name:"lc07zm",styles:"color:red;font-size:14px;margin-top:5px"}),P=(0,s.A)("a",{target:"eldja684"})('display:inline-block;line-height:18px;font-family:"Ginto","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:600;color:',k.w4.colors.contentAccent,";text-decoration:none;cursor:pointer;&:hover,&:focus{text-decoration:none;color:",k.w4.colors.contentAccentHover,";}",A.Zp," ",A.xe," ",A.yW,";"),q=(0,s.A)("label",{target:"eldja683"})("font-weight:600;color:",$,";margin-bottom:6px;display:block;"),B=(0,s.A)("div",{target:"eldja682"})('display:inline-block;font-family:"Ginto","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:600;color:',k.w4.colors.contentAccent,";text-decoration:none;cursor:pointer;&:hover,&:focus{text-decoration:none;color:",k.w4.colors.contentAccentHover,";}",A.xe,";"),L=(0,s.A)("form",{target:"eldja681"})({name:"1d3w5wq",styles:"width:100%"}),M=(0,s.A)("div",{target:"eldja680"})("background-color:",H,";padding:16px;text-align:center;"),U=e=>{let{remainingAttempts:o}=e;if(null===o)return null;const t=1===o?"components.login.one_attempt":"components.login.num_of_attempts";return o<=5?(0,F.jsx)(v.Fragment,null,(0,F.jsx)(p.EY,{fontSize:"2",fontWeight:"bold",color:"#2C2A50"},(0,F.jsx)(g.A,{path:t,subs:{attempts:o.toString()}})),(0,F.jsx)(p.EY,{fontSize:"2"},(0,F.jsx)(g.A,{path:"components.login.lockout_warning"}))):(0,F.jsx)(v.Fragment,null,(0,F.jsx)(p.EY,{fontSize:"2",display:"inline",role:"alert","aria-live":"polite"},(0,F.jsx)(g.A,{path:"components.login.invalid_email_or_password"})))};var V={name:"1a8wwya",styles:"background-color:#ffecee;color:#d72a2b;border-radius:30px;font-weight:600"},D={name:"1jjzo8x",styles:"background-color:#dff0d8;border-color:#d6e9c6;color:#3c763d;border-radius:5px"};const G=e=>{let{apiAnswer:o,remainingAttempts:t}=e;if(null===o.code)return null;const s="success"===o.code?D:V;return(0,F.jsx)(b.az,{my:3,p:3,textAlign:"center",css:s},"success"===o.code&&(0,F.jsx)(p.EY,{fontSize:"2"},(0,F.jsx)(g.A,{path:"components.login.login_success"})),"api-error"===o.code&&(0,F.jsx)(v.Fragment,null,(0,F.jsx)(p.EY,{fontSize:"2",display:"inline"},(0,F.jsx)(g.A,{path:"components.login.login_error"})),(0,F.jsx)(P,{ml:"5px",href:"https://status.classdojo.com",color:"#00bcf2",hoverColor:"#00a8d9",display:"inline"},(0,F.jsx)(g.A,{path:"components.login.check_status_page"}))),"auth-error"===o.code&&(0,F.jsx)(U,{remainingAttempts:t}),"auth-suspended"===o.code&&(0,F.jsx)(p.EY,{fontSize:"2",display:"inline",role:"alert","aria-live":"polite"},(0,F.jsx)(g.A,{path:"components.login.suspended_user"})))};var K={name:"1vl6i32",styles:"gap:15px;display:flex;flex-direction:column"};o.A=e=>{let{userType:o,noRedirect:t,closeModal:s,signToWatch:n,emailPrefill:f,showCodeLogin:A,disableHeader:H}=e;const $=(0,v.useContext)(m.x),{data:{geolocation:P}}=(0,v.useContext)(i.h9),U=(0,v.useContext)(I.Vs),V=(0,v.useContext)(i.h9),D=(0,v.useContext)(h.C),X="test"===(0,z.u)(R._B.WEB_EXTERNAL_TEACH_SSO_SIGNUP_OPTION_V1).actualValue&&("teacher"===o||"leader"===o);function Z(){U.showModal(I.q3.Signup)}(0,N.G1)(R._B.WEB_EXTERNAL_TEACH_SSO_SIGNUP_OPTION_V1,{isInAudience:"teacher"===o||"leader"===o}),(0,v.useEffect)(()=>{(0,x.$s)({eventName:"web.login.screen_view",metadata:{current_site:"external",account_type:o}})},[o]);const{0:J,1:Q}=(0,v.useState)({code:null}),{0:ee,1:oe}=(0,v.useState)(void 0),te="parent"===o,se=!te||!(P&&"ny"===P.state);(0,v.useEffect)(()=>{(0,x.$s)({eventName:"web.external_page.login.detected_state",eventValue:P&&P.state})},[]);const ne=(0,w.Wx)({initialValues:{login:null!=f?f:"",password:"",longSession:se},validationSchema:T.Ik().shape({login:T.Yj().required($.translate("layouts.login.login_required").toString()).email($.translate("layouts.login.login_valid_emal").toString()),password:T.Yj().required($.translate("layouts.login.password_required").toString())}),onSubmit:(e,s)=>{var n,r;let{login:l,password:i,longSession:c}=e,{setSubmitting:d}=s;const u=`${"teacher"===o?"https://teach.classdojo.com":"https://home.classdojo.com"}/api/session?duration=${c?"long":"short"}`;j.A.post(u,{login:l,password:i,resumeAddClassFlow:!(null===_()||void 0===_()||null===(n=_().location)||void 0===n||null===(r=n.href)||void 0===r||!r.match(/\/connect/))},{withCredentials:!0}).then(e=>{Q({code:"success"});const{data:s}=e,n=s.teacher||s.parent||s.student;if(n&&(0,x.Lv)(n._id),(0,x.$s)({eventName:"web.login.success",entityId:null==n?void 0:n._id,metadata:{current_site:"external",account_type:o}}),D.getRedirectionStatus())if(t)V.services.getSession(),U.hideModal();else{var a;let o="https://home.classdojo.com";"teacher"===e.data.type?o="https://teach.classdojo.com":"student"===e.data.type&&(o="https://student.classdojo.com"),_().location.href=null!==(a=o)&&void 0!==a?a:""}else V.services.getSession(),D.runSuccessAction(),U.hideModal()}).catch(e=>{const t=a()(e,"response.headers.remaining-attempts");(0,x.$s)({eventName:"web.login.failure",metadata:{current_site:"external",account_type:o}}),oe(void 0===t?void 0:parseInt(t,10));const s=a()(e,"response.data.error.detail"),n=a()(e,"response.data.error.code"),r=a()(e,"response.data.error.fallbackMessage");if("Incorrect password"===s||"Incorrect username"===s)Q({code:"auth-error"});else if("Too many login attempts, user is temporarily locked out of login"===s)Q({code:"auth-lockout"});else if("User is suspended"===s)Q({code:"auth-suspended"});else if(null!=n&&n.startsWith("ERR_MUST_USE_OTC"))Q({code:"forced-otc",detail:{message:r}});else if("ERR_COMPROMISED_PASSWORD"===n)_().location.href="parent"===o?`https://home.classdojo.com/#/forceReset?email=${encodeURIComponent(l)}`:`https://teach.classdojo.com/#/forceReset?email=${encodeURIComponent(l)}`;else{const o=a()(e,"response.data");(0,x.$s)({eventName:"login.error.unknown.detail",value:s,metadata:{error:s,response:o}}),Q({code:"api-error"})}}).then(function(){d(!1)})}});function ae(){(0,x.$s)({eventName:"web.account_recovery.forgot_password.reset_password_tap",metadata:{account_type:o,current_site:"external"}}),U.showModal(I.q3.ResetPassword,{userType:o,previousEmail:ne.values.login})}const{0:re,1:le}=(0,v.useState)(!1),ie=e=>{let{showLoginWithCode:o}=e;le(o),H(o)};return re?(0,F.jsx)(E.A,{email:ne.values.login||f,goBackToLogin:e=>{let{email:o}=e;o&&ne.setFieldValue("login",o),ie({showLoginWithCode:!1})},isUserParent:"parent"===o,userType:o}):"auth-lockout"===J.code?(0,F.jsx)(b.az,{my:3,p:3,textAlign:"center"},(0,F.jsx)("img",{alt:"",src:l.A}),(0,F.jsx)(p.EY,{fontSize:4,fontWeight:800},(0,F.jsx)(g.A,{path:"components.login.lockout_header"})),(0,F.jsx)(p.EY,null,(0,F.jsx)(g.A,{path:"components.login.lockout_desc"})),(0,F.jsx)(y.A,{onClick:s,width:"100%"},(0,F.jsx)(g.A,{path:"components.login.lockout_button"}))):"forced-otc"===J.code?(0,F.jsx)(d.A,{userType:o,email:ne.values.login,password:ne.values.password,isUserParent:"parent"===o,headerText:J.detail.message}):(0,F.jsx)(L,{onSubmit:ne.handleSubmit,"data-test-name":"login-form"},n&&(0,F.jsx)(v.Fragment,null,(0,F.jsx)(M,null,(0,F.jsx)(k.io,{color:Y},n)),(0,F.jsx)(k.$x,{size:"m"})),ne.isSubmitting&&(0,F.jsx)(b.az,{width:"50px",height:"50px",mb:4,mx:"auto"},(0,F.jsx)("img",{alt:"Loading mojo",src:r.A})),(0,F.jsx)("div",{css:K},(0,F.jsx)("div",null,(0,F.jsx)(q,{htmlFor:"email"},$.translate("components.common.email_address").toString()),(0,F.jsx)(S.A,{id:"email","aria-label":$.translate("components.common.email_address"),autoComplete:"email",required:!0,name:"login",onChange:ne.handleChange,value:ne.values.login,success:!ne.errors.login&&ne.touched.login,error:!!ne.errors.login&&ne.touched.login,onBlur:ne.handleBlur,"aria-describedby":ne.errors.login&&ne.touched.login?"login-error":void 0}),(0,F.jsx)(O,{id:"login-error",role:"alert","aria-live":"polite"},ne.errors.login&&ne.touched.login&&ne.errors.login)),(0,F.jsx)("div",null,(0,F.jsx)(q,{htmlFor:"password"},$.translate("components.common.password").toString()),(0,F.jsx)(S.A,{id:"password","aria-label":$.translate("components.common.password"),autoComplete:"off",type:"password",name:"password",required:!0,onChange:ne.handleChange,autoFocus:!!f,value:ne.values.password,success:!ne.errors.password&&ne.touched.password,error:!!ne.errors.password&&ne.touched.password,onBlur:ne.handleBlur,"aria-describedby":ne.errors.password&&ne.touched.password?"password-error":void 0}),(0,F.jsx)(O,{id:"password-error",role:"alert","aria-live":"polite"},ne.errors.password&&ne.touched.password&&ne.errors.password))),(0,F.jsx)(B,{role:"button","aria-label":"Click here to recover password",tabIndex:0,onClick:ae,onKeyDown:e=>"Enter"===e.key&&ae(),mb:"5px",mt:"5px"},$.translate("components.login.forget_password")),(0,F.jsx)(G,{apiAnswer:J,remainingAttempts:null!=ee?ee:null}),(0,F.jsx)(y.A,{disabled:ne.isSubmitting||(!ne.isValid||!ne.dirty)&&!A,type:"submit",big:!0,width:"100%",my:"5px"},$.translate("pages.home.log_in")),te&&(0,F.jsx)(c.A,{name:"longSession",checked:!!ne.values.longSession,onChange:ne.handleChange},"Keep me logged in"),(0,F.jsx)(b.so,{justifyContent:"center",alignItems:"center",mt:"5px"},(0,F.jsx)(p.EY,{fontSize:2}," ",$.translate("components.login.dont_have_account")),(0,F.jsx)(B,{role:"button",tabIndex:0,onClick:Z,onKeyDown:e=>"Enter"===e.key&&Z(),mb:"10px",ml:"5px"},$.translate("pages.home.sign_up"))),A&&(0,F.jsx)(v.Fragment,null,(0,F.jsx)(u.H,null),X&&(0,F.jsx)(W.D,{providerSlug:"google"}),(0,F.jsx)(C.A,{loginWithCode:()=>ie({showLoginWithCode:!0})})),!A&&X&&(0,F.jsx)(v.Fragment,null,(0,F.jsx)(u.H,null),(0,F.jsx)(W.D,{providerSlug:"google"})))}}}]);
//# sourceMappingURL=5fe724ee-28a90ba65850f3a23f41.js.map